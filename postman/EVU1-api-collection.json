{
  "info": {
    "name": "EVU1 API - Proyectos",
    "_postman_id": "evu1-proyectos-collection",
    "description": "Colección para probar los endpoints API de Proyectos (JWT). Importar en Postman o Insomnia.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://evu1.test" },
    { "key": "token", "value": "" },
    { "key": "test_user_email", "value": "test@example.com" },
    { "key": "test_user_password", "value": "password" }
  ],
  "item": [
    {
      "name": "Register (optional)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Usuario Prueba\",\n  \"email\": \"{{test_user_email}}\",\n  \"password\": \"{{test_user_password}}\",\n  \"password_confirmation\": \"{{test_user_password}}\"\n}"
        },
        "url": { "raw": "{{baseUrl}}/api/register", "host": [ "{{baseUrl}}" ], "path": [ "api", "register" ] }
      },
      "response": [
        {
          "name": "201 Created (example)",
          "status": "Created",
          "code": 201,
          "body": "{\n  \"message\": \"Usuario registrado con éxito\",\n  \"user\": {\n    \"id\": 1,\n    \"name\": \"Usuario Prueba\",\n    \"email\": \"test@example.com\"\n  }\n}"
        }
      ]
    },
    {
      "name": "Login (get JWT token)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"{{test_user_email}}\",\n  \"password\": \"{{test_user_password}}\"\n}"
        },
        "url": { "raw": "{{baseUrl}}/api/login", "host": [ "{{baseUrl}}" ], "path": [ "api", "login" ] }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "// Extrae token JWT de la respuesta y lo guarda en la variable de entorno 'token'",
              "if (pm.response.code === 200) {",
              "  var json = pm.response.json();",
              "  if (json.token) {",
              "    pm.environment.set('token', json.token);",
              "    console.log('token saved');",
              "  }",
              "}",
              "pm.test('Status is 200', function () { pm.response.to.have.status(200); });"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "response": [
        {
          "name": "200 OK (example)",
          "status": "OK",
          "code": 200,
          "body": "{\n  \"token\": \"eyJ0eXAiOiJKV1QiLCJhbGci...\"\n}"
        },
        {
          "name": "401 Unauthorized (example)",
          "status": "Unauthorized",
          "code": 401,
          "body": "{\n  \"message\": \"Datos inválidos\"\n}"
        }
      ]
    },
    {
      "name": "GET /api/proyectos (List)",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Accept", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "url": { "raw": "{{baseUrl}}/api/proyectos", "host": [ "{{baseUrl}}" ], "path": [ "api", "proyectos" ] }
      },
      "response": [
        {
          "name": "200 OK (example) - array",
          "status": "OK",
          "code": 200,
          "body": "[\n  {\n    \"id\": 1,\n    \"nombre\": \"Proyecto A\",\n    \"fecha_inicio\": \"2025-09-01\",\n    \"estado\": \"activo\",\n    \"responsable\": \"Ervin\",\n    \"monto\": 1000.5,\n    \"created_by\": 1\n  }\n]"
        },
        {
          "name": "200 OK (example) - empty array",
          "status": "OK",
          "code": 200,
          "body": "[]"
        }
      ]
    },
    {
      "name": "POST /api/proyectos (Create)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"nombre\": \"Proyecto Nuevo\",\n  \"fecha_inicio\": \"2025-09-07\",\n  \"estado\": \"planificado\",\n  \"responsable\": \"Ervin\",\n  \"monto\": 2500.00\n}"
        },
        "url": { "raw": "{{baseUrl}}/api/proyectos", "host": [ "{{baseUrl}}" ], "path": [ "api", "proyectos" ] }
      },
      "response": [
        {
          "name": "201 Created (example)",
          "status": "Created",
          "code": 201,
          "body": "{\n  \"id\": 2,\n  \"nombre\": \"Proyecto Nuevo\",\n  \"fecha_inicio\": \"2025-09-07\",\n  \"estado\": \"planificado\",\n  \"responsable\": \"Ervin\",\n  \"monto\": 2500,\n  \"created_by\": 1\n}"
        },
        {
          "name": "422 Validation Error (example)",
          "status": "Unprocessable Entity",
          "code": 422,
          "body": "{\n  \"message\": \"The given data was invalid.\",\n  \"errors\": {\n    \"nombre\": [\"The nombre field is required.\"]\n  }\n}"
        }
      ]
    },
    {
      "name": "GET /api/proyectos/{id} (Show)",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Accept", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "url": { "raw": "{{baseUrl}}/api/proyectos/1", "host": [ "{{baseUrl}}" ], "path": [ "api", "proyectos", "1" ] }
      },
      "response": [
        {
          "name": "200 OK (example)",
          "status": "OK",
          "code": 200,
          "body": "{\n  \"id\": 1,\n  \"nombre\": \"Proyecto A\",\n  \"fecha_inicio\": \"2025-09-01\",\n  \"estado\": \"activo\",\n  \"responsable\": \"Ervin\",\n  \"monto\": 1000.5,\n  \"created_by\": 1\n}"
        },
        {
          "name": "404 Not Found (example)",
          "status": "Not Found",
          "code": 404,
          "body": "{\n  \"message\": \"Not Found\"\n}"
        }
      ]
    },
    {
      "name": "PUT /api/proyectos/{id} (Update)",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"nombre\": \"Proyecto A (mod)\",\n  \"fecha_inicio\": \"2025-09-02\",\n  \"estado\": \"activo\",\n  \"responsable\": \"Ervin\",\n  \"monto\": 1100.00\n}"
        },
        "url": { "raw": "{{baseUrl}}/api/proyectos/1", "host": [ "{{baseUrl}}" ], "path": [ "api", "proyectos", "1" ] }
      },
      "response": [
        {
          "name": "200 OK (example)",
          "status": "OK",
          "code": 200,
          "body": "{\n  \"id\": 1,\n  \"nombre\": \"Proyecto A (mod)\",\n  \"fecha_inicio\": \"2025-09-02\",\n  \"estado\": \"activo\",\n  \"responsable\": \"Ervin\",\n  \"monto\": 1100,\n  \"created_by\": 1\n}"
        },
        {
          "name": "404 Not Found (example)",
          "status": "Not Found",
          "code": 404,
          "body": "{\n  \"message\": \"Not Found\"\n}"
        }
      ]
    },
    {
      "name": "DELETE /api/proyectos/{id}",
      "request": {
        "method": "DELETE",
        "header": [
          { "key": "Accept", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "url": { "raw": "{{baseUrl}}/api/proyectos/1", "host": [ "{{baseUrl}}" ], "path": [ "api", "proyectos", "1" ] }
      },
      "response": [
        {
          "name": "204 No Content (example)",
          "status": "No Content",
          "code": 204,
          "body": ""
        },
        {
          "name": "404 Not Found (example)",
          "status": "Not Found",
          "code": 404,
          "body": "{\n  \"message\": \"Not Found\"\n}"
        }
      ]
    }
  ]
}
